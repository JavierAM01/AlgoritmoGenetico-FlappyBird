import pygame, random
import torch as T # we only use : T.tensor
from model import Net_FlappyBird

from constants import *
from game import Game, Bird


class Bird_AI(Bird):

    def __init__(self):
        super().__init__()
        self.brain = Net_FlappyBird(input_size=3)
    
    # 0 -> not jump / 1 -> jump
    def move(self, state):
        state = T.tensor(state, dtype=T.float)
        evaluation = self.brain.forward(state)
        return 1 if evaluation > 0.5 else 0
    

class Game_AI(Game):

    def __init__(self):
        super().__init__()
        self.bird = Bird_AI()